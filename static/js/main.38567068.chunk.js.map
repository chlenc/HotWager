{"version":3,"sources":["Components/LoginBtn.tsx","Components/App/index.tsx","serviceWorker.ts","utils.ts","stores/SubStore.ts","constants.ts","stores/AccountsStore.ts","stores/DappStore.ts","index.tsx","stores/RootStore.ts"],"names":["LoginBtn","instance","setRef","component","this","props","botName","buttonSize","cornerRadius","requestAccess","usePic","onLogin","user","console","log","window","TelegramLoginWidget","dataOnauth","script","document","createElement","src","setAttribute","toString","async","appendChild","className","ref","children","React","Component","App","inject","observer","handleTelegramResponse","response","accountsStore","updateUser","address","dappStore","k1","k2","story","chooseEvent","withdraw","load","Grid","style","display","flexDirection","justifyContent","padding","container","spacing","justify","alignItems","item","xs","CardHeader","avatar","Avatar","alt","photo_url","Skeleton","variant","width","height","subheader","title","balance","k","marginTop","Button","disabled","seed","onClick","color","Table","aria-label","TableHead","TableRow","TableCell","align","TableBody","map","i","e","key","scope","EventCard1","Card","margin","CardActionArea","CardContent","Typography","gutterBottom","CardActions","EventCard2","Boolean","location","hostname","match","SubStore","rootStore","dApp","nodeUrl","AccountsStore","initState","serialize","tgUser","deserialize","id","randomSeed","buildAddress","axios","get","data","observable","action","DappStore","startWatchState","autorun","reaction","updateStateAndBalance","scheduler","run","setInterval","value","a","params","feeAssetId","call","function","args","type","payment","assetId","amount","chainId","tx","invokeScript","broadcast","then","d","catch","alert","updateBalance","reducer","acc","state","reduce","q1_next","q2_next","count1","n","count2","m","Object","entries","filter","split","mobXStore","JSON","parse","localStorage","getItem","undefined","error","loadState","dir","setItem","stringify","delay","ReactDOM","render","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.38567068.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nexport interface IUser {\r\n    auth_date: number\r\n    hash: string\r\n    id: number\r\n    first_name?: string\r\n    last_name?: string\r\n    balance?: number\r\n    photo_url?: string\r\n    username?: string\r\n    seed?: string\r\n    address?: string\r\n}\r\n\r\ninterface IProps {\r\n    botName: string\r\n    onLogin?: (user: IUser) => void\r\n    buttonSize?: 'large' | 'medium' | 'small',\r\n    cornerRadius?: number,\r\n    requestAccess?: string,\r\n    usePic?: boolean,\r\n    className?: string\r\n}\r\n\r\nclass LoginBtn extends React.Component<IProps> {\r\n\r\n    instance: any;\r\n\r\n    setRef = (component: any) => {\r\n        this.instance = component;\r\n    };\r\n\r\n    componentDidMount() {\r\n        const {\r\n            botName,\r\n            buttonSize = 'medium',\r\n            cornerRadius,\r\n            requestAccess = 'write',\r\n            usePic = false,\r\n            onLogin = (user: any) => console.log(user)\r\n        } = this.props;\r\n\r\n        if (!botName) return <div>bot name is undefined</div>;\r\n\r\n        window.TelegramLoginWidget = {dataOnauth: (user: IUser) => onLogin(user)};\r\n\r\n        const script = document.createElement('script');\r\n        script.src = 'https://telegram.org/js/telegram-widget.js?4';\r\n        script.setAttribute('data-telegram-login', botName);\r\n        script.setAttribute('data-size', buttonSize);\r\n        cornerRadius && script.setAttribute('data-radius', cornerRadius.toString());\r\n        script.setAttribute('data-request-access', requestAccess);\r\n        script.setAttribute('data-userpic', usePic.toString());\r\n        script.setAttribute('data-onauth', 'TelegramLoginWidget.dataOnauth(user)');\r\n        script.async = true;\r\n        this.instance.appendChild(script);\r\n    }\r\n\r\n    render() {\r\n        return <div className={this.props.className} ref={this.setRef}>{this.props.children}</div>;\r\n    }\r\n}\r\n\r\n\r\nexport default LoginBtn;\r\n","import React from 'react';\r\nimport LoginBtn, { IUser } from \"../LoginBtn\";\r\nimport {\r\n    Button,\r\n    Card,\r\n    CardActionArea,\r\n    CardActions,\r\n    CardContent,\r\n    Grid,\r\n    Table,\r\n    TableBody,\r\n    TableCell,\r\n    TableHead,\r\n    TableRow,\r\n    Typography\r\n} from \"@material-ui/core\";\r\nimport CardHeader from '@material-ui/core/CardHeader';\r\nimport Avatar from '@material-ui/core/Avatar';\r\nimport { Skeleton } from '@material-ui/lab';\r\nimport { AccountsStore, DappStore } from \"../../stores\";\r\nimport { inject, observer } from 'mobx-react';\r\n\r\ninterface IInjectedProps {\r\n    accountsStore?: AccountsStore\r\n    dappStore?: DappStore\r\n}\r\n\r\n@inject('accountsStore', 'dappStore')\r\n@observer\r\nclass App extends React.Component<IInjectedProps> {\r\n\r\n    handleTelegramResponse = (response: any) => {\r\n        console.log(this.props.accountsStore!.updateUser(response).address);\r\n    };\r\n\r\n    render() {\r\n        const user = this.props.accountsStore!.user;\r\n        const {k1, k2, story, chooseEvent, withdraw, load} = this.props.dappStore!;\r\n        return <Grid style={{display: 'flex', flexDirection: 'column', justifyContent: 'flex-start', padding: '20px'}}  container spacing={6} justify=\"space-between\" alignItems=\"center\">\r\n            <Grid item xs={6}>\r\n                <CardHeader\r\n                    avatar={!user\r\n                        ? <Skeleton variant=\"circle\" width={40} height={40}/>\r\n                        : <Avatar alt=\"Ted talk\" src={user.photo_url}/>}\r\n                    subheader={!user ? <Skeleton height={6} width=\"40%\"/> : user.address}\r\n                    title={!user ? <Skeleton height={6} width=\"80%\"/> :\r\n                        <div>balance:&nbsp;{user.balance}&nbsp;waves</div>}\r\n                />\r\n            </Grid>\r\n            <Grid item xs={6}>\r\n                <LoginBtn botName={'HotWagerBot'} onLogin={this.handleTelegramResponse} usePic/>\r\n            </Grid>\r\n            <Grid item xs={6} >\r\n                <div style={{display: 'flex', justifyContent: 'space-between'}}>\r\n                    <EventCard1 title={'Event 1'} k={k1} user={user} chooseEvent={chooseEvent} load={load}/>\r\n                    <EventCard2 title={'Event 2'} k={k2} user={user} chooseEvent={chooseEvent} load={load}/>\r\n                </div>\r\n                <div style={{display: 'flex', marginTop: '50px', justifyContent: \"center\"}}>\r\n                    <Button\r\n                        disabled={load || !user || !user.seed}\r\n                        onClick={() => withdraw(user!.seed || '')} variant=\"contained\" color=\"secondary\">\r\n                        Withdraw\r\n                    </Button>\r\n                </div>\r\n            </Grid>\r\n            {story && <Grid item xs={6}>\r\n                <Table aria-label=\"simple table\" style={{width: 'unset'}}>\r\n                    <TableHead>\r\n                        <TableRow>\r\n                            <TableCell align=\"right\">Index</TableCell>\r\n                            <TableCell align=\"right\">Coefficient 1</TableCell>\r\n                            <TableCell align=\"right\">Coefficient 2</TableCell>\r\n                            <TableCell>Your choose</TableCell>\r\n                        </TableRow>\r\n                    </TableHead>\r\n                    <TableBody>\r\n                        {story.map(({k1, k2, i, e}) => (\r\n                            <TableRow key={i}>\r\n                                <TableCell component=\"th\" scope=\"row\">{i}</TableCell>\r\n                                <TableCell align=\"right\">{k1 / 100}</TableCell>\r\n                                <TableCell align=\"right\">{k2 / 100}</TableCell>\r\n                                <TableCell align=\"right\">{e}</TableCell>\r\n                            </TableRow>\r\n                        ))}\r\n                    </TableBody>\r\n                </Table>\r\n            </Grid>}\r\n        </Grid>;\r\n    }\r\n\r\n}\r\n\r\ninterface IEventCardProps {\r\n    title: string,\r\n    k: number | null,\r\n    user: IUser | null,\r\n    chooseEvent: (n: number, s: string) => void\r\n    load: boolean\r\n}\r\n\r\nclass EventCard1 extends React.Component<IEventCardProps> {\r\n    render() {\r\n        const {title, k, user, chooseEvent, load} = this.props;\r\n        return <Card\r\n            style={{width: '250px', margin: '20px'}}>\r\n            <CardActionArea>\r\n                <CardContent>\r\n                    <Typography gutterBottom variant=\"h5\" component=\"h2\">\r\n                        {title}\r\n                    </Typography>\r\n                    <Typography gutterBottom variant=\"h5\" component=\"h3\">\r\n                        {k && k / 100}\r\n                    </Typography>\r\n                    <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\r\n                        Lizards are a widespread group of squamate reptiles, with over 6,000 species, ranging\r\n                        across all continents except Antarctica\r\n                    </Typography>\r\n                </CardContent>\r\n            </CardActionArea>\r\n            <CardActions>\r\n                <Button\r\n                    disabled={load || !user || !user.seed}\r\n                    onClick={() => chooseEvent(1, user!.seed || '')} variant=\"contained\" color=\"primary\">\r\n                    Choose event\r\n                </Button>\r\n            </CardActions>\r\n        </Card>;\r\n    }\r\n}\r\n\r\nclass EventCard2 extends React.Component<IEventCardProps> {\r\n    render() {\r\n        const {title, k, user, chooseEvent, load} = this.props;\r\n        return <Card\r\n            style={{width: '250px', margin: '20px'}}>\r\n            <CardActionArea>\r\n                <CardContent>\r\n                    <Typography gutterBottom variant=\"h5\" component=\"h2\">\r\n                        {title}\r\n                    </Typography>\r\n                    <Typography gutterBottom variant=\"h5\" component=\"h3\">\r\n                        {k && k / 100}\r\n                    </Typography>\r\n                    <Typography variant=\"body2\" color=\"textSecondary\" component=\"p\">\r\n                        Lizards are a widespread group of squamate reptiles, with over 6,000 species, ranging\r\n                        across all continents except Antarctica\r\n                    </Typography>\r\n                </CardContent>\r\n            </CardActionArea>\r\n            <CardActions>\r\n                <Button\r\n                    disabled={load || !user || !user.seed}\r\n                    onClick={() => chooseEvent(2, user!.seed || '')} variant=\"contained\" color=\"primary\">\r\n                    Choose event\r\n                </Button>\r\n            </CardActions>\r\n        </Card>;\r\n    }\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\ntype Config = {\r\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\r\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\r\n};\r\n\r\nexport function register(config?: Config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(\r\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\r\n      window.location.href\r\n    );\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl: string, config?: Config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","\r\nexport const loadState = (): any | undefined => {\r\n    try {\r\n        const state = JSON.parse(localStorage.getItem('store') as string);\r\n        return state || undefined;\r\n\r\n    } catch (error) {\r\n        console.log(error);\r\n        return undefined;\r\n    }\r\n\r\n};\r\nexport const saveState = (state: any): void => {\r\n    localStorage.setItem('store', JSON.stringify(state));\r\n};\r\n\r\n","import RootStore from './RootStore';\r\n\r\nclass SubStore {\r\n    constructor(public rootStore: RootStore) {\r\n    }\r\n}\r\n\r\nexport default SubStore;\r\n","export const dApp = '3N3AeA5FWm7EHheHoik8BBEA3GXXJosnVY8';\r\nexport const nodeUrl = 'https://testnode1.wavesnodes.com';\r\n","import RootStore from './RootStore';\r\nimport SubStore from './SubStore';\r\nimport { action, observable } from \"mobx\";\r\nimport { IUser } from \"../Components/LoginBtn\";\r\nimport { address as buildAddress, randomSeed } from '@waves/ts-lib-crypto';\r\nimport axios from \"axios\";\r\nimport { nodeUrl } from \"../constants\";\r\n\r\n\r\nexport class AccountsStore extends SubStore {\r\n\r\n    @observable user: IUser | null = null;\r\n\r\n    @action\r\n    public updateUser(user: IUser) {\r\n        if (!this.user || this.user.id !== user.id) {\r\n            user.seed = randomSeed();\r\n            user.address = buildAddress(user.seed, 'T');\r\n            //todo show notification\r\n            this.user = user;\r\n        }\r\n        return this.user\r\n    }\r\n\r\n    @action\r\n    async updateBalance() {\r\n        if (this.user && this.user.address) {\r\n            const {data: {balance}} = await axios.get(`${nodeUrl}/addresses/balance/${this.user.address}`);\r\n            this.user.balance = balance / 1e8\r\n        }\r\n    }\r\n\r\n    constructor(rootStore: RootStore, initState: any) {\r\n        super(rootStore);\r\n        if (initState != null) this.deserialize(initState)\r\n    }\r\n\r\n    public serialize = () => ({tgUser: this.user});\r\n\r\n    @action private deserialize = (initState: any) => {\r\n        if (initState.tgUser) this.user = initState.tgUser\r\n    }\r\n}\r\n\r\n","import RootStore from './RootStore';\r\nimport SubStore from './SubStore';\r\nimport { action, autorun, observable } from \"mobx\";\r\nimport axios from \"axios\";\r\nimport { dApp, nodeUrl } from \"../constants\";\r\nimport { IInvokeScriptParams } from \"@waves/waves-transactions/src/transactions\";\r\nimport { broadcast, invokeScript } from \"@waves/waves-transactions\";\r\n\r\nexport type TStoryItem = { e: number, k1: number, k2: number, i: number }\r\n\r\nexport class DappStore extends SubStore {\r\n\r\n    @observable k1: number | null = null;\r\n    @observable k2: number | null = null;\r\n    @observable count1: number | null = null;\r\n    @observable count2: number | null = null;\r\n    @observable story: TStoryItem[] | null = null;\r\n    @observable load: boolean = false;\r\n\r\n    constructor(rootStore: RootStore) {\r\n        super(rootStore);\r\n        this.updateStateAndBalance();\r\n        this.startWatchState()\r\n    }\r\n\r\n\r\n    private startWatchState = () =>\r\n        autorun((reaction) => this.updateStateAndBalance(), {scheduler: run => setInterval(run, 5000)})\r\n\r\n    @action\r\n    private updateStateAndBalance = async () => {\r\n        if (!this.rootStore.accountsStore.user || !this.rootStore.accountsStore.user.address) return;\r\n        const address = this.rootStore.accountsStore.user.address;\r\n        this.rootStore.accountsStore.updateBalance();\r\n        const {data} = await axios.get(`${nodeUrl}/addresses/data/${dApp}`);\r\n        const reducer = (acc: { [key: string]: string | number },\r\n                         {key, value}: { key: string, value: string | number }\r\n        ) => ({...acc, [key]: value});\r\n        const state = data.reduce(reducer, {});\r\n        this.k1 = state.q1_next;\r\n        this.k2 = state.q2_next;\r\n        this.count1 = state.n;\r\n        this.count2 = state.m;\r\n\r\n        this.story = Object.entries(state)\r\n            .filter(([_, val]) => val === address)\r\n            .map(([key]) => key.split('_')[0])\r\n            .map((i): TStoryItem => ({\r\n                e: state[`${i}_event`],\r\n                k1: state[`${i}_qoef1`],\r\n                k2: state[`${i}_qoef2`],\r\n                i: +i,\r\n            }))\r\n    }\r\n\r\n\r\n    chooseEvent = async (value: number, seed: string) => {\r\n        this.load = true;\r\n        const params: IInvokeScriptParams = {\r\n            dApp,\r\n            feeAssetId: null,\r\n            call: {function: 'bet', args: [{type: 'integer', value}]},\r\n            payment: [{assetId: null, amount: 1e8}],\r\n            chainId: 'T'\r\n        };\r\n        const tx = invokeScript(params, seed);\r\n        await broadcast(tx, nodeUrl).then(d => console.log(d.id)).catch(e => alert(e)).then(() => this.load = false)\r\n    }\r\n\r\n\r\n    withdraw = async (seed: string) => {\r\n        const params: IInvokeScriptParams = {\r\n            dApp,\r\n            feeAssetId: null,\r\n            call: {function: 'withdraw', args: []},\r\n            payment: [],\r\n            chainId: 'T'\r\n        };\r\n        const tx = invokeScript(params, seed);\r\n        broadcast(tx, nodeUrl).then(d => console.log(d.id)).catch(e => alert(e)).then(() => this.load = false)\r\n    }\r\n\r\n\r\n}\r\n\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './Components/App';\r\nimport * as serviceWorker from './serviceWorker';\r\nimport { loadState, saveState } from './utils';\r\nimport { RootStore } from \"./stores\";\r\nimport { autorun } from \"mobx\";\r\nimport { Provider } from 'mobx-react';\r\n\r\n// Store init\r\nconst initState = loadState();\r\nconst mobXStore = new RootStore(initState);\r\nautorun(() => {\r\n    console.dir(mobXStore);\r\n    saveState(mobXStore.serialize());\r\n}, {delay: 1000});\r\n\r\nReactDOM.render(  <Provider {...mobXStore}><App /></Provider>, document.getElementById('root'));\r\n\r\nserviceWorker.unregister();\r\n","\r\nimport { AccountsStore, DappStore} from './';\r\n\r\nclass RootStore {\r\n    public accountsStore: AccountsStore;\r\n    public dappStore: DappStore;\r\n\r\n    constructor(initState?: any) {\r\n\r\n        if (initState == null) {\r\n            initState = {};\r\n        }\r\n        this.accountsStore = new AccountsStore(this, initState.accountsStore);\r\n        this.dappStore = new DappStore(this);\r\n    }\r\n\r\n    public serialize = () => ({\r\n        accountsStore: this.accountsStore.serialize(),\r\n    });\r\n}\r\n\r\nexport default RootStore;\r\n"],"sourceRoot":""}